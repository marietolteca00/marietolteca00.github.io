{
  "hash": "472d68e712d54c13d6a27f006a69ddcd",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Prioritizing Aquaculture Sites Along the West Coast\"\ndescription: \"Marine Aquaculture West Coast Exclusive Economic Zones (EEZ)\"\nauthor:\n  - name: Marie Tolteca\n    affiliation: Master of Environmental Data Science Program at The Bren School (UCSB)\n    affiliation-url: https://ucsb-meds.github.io/\ndate: \"2025-12-11\"\ncategories: [Quarto, R, MEDS]\ncitation:\n  url: https://marietolteca00.github.io/blog_post/prioritizing_west_coast_aquaculture_sites\nimage: oceanfarming.jpg\ndraft: false\nformat: \n  html:\n    code-fold: true\n    toc: true\n---\n# Background\n\n\nThere is a growing global need to sustainably feed expanding human populations, and one promising solution is marine aquaculture[^2]. Aquaculture involves the organized cultivation, feeding, propagation, and production of aquatic organisms for commercial, recreational, or public use. The industry can support food security while contributing to conservation and economic development. Globally, [Gentry et al](https://www.nature.com/articles/s41559-017-0257-9), found environmental and logistical constraints, such as seafloor depth, dissolved oxygen, and ship traffic limit the area suitable for marine aquaculture to less than 0.015% of the world’s oceans. This highlights the importance of carefully identifying viable locations.\n\nAlong the U.S. West Coast, aquaculture includes diverse systems and species, from shellfish to finfish, each with unique environmental requirements. As research has shown, oysters represent one of the most commercially significant mollusk species, thriving at depths of 0–70 meters and sea surface temperatures (SSTs) between 11–30°C. Another species of personal interest in this analysis, the California sea hare (Aplysia californica), occurs at depths of 0–22 meters and SSTs of 13.4–27.1°C, making it a candidate for evaluation using similar environmental criteria. Understanding where the suitable ranges of these species overlap within Exclusive Economic Zones (EEZs) is critical for identifying areas where aquaculture can be both sustainable and commercially feasible.\n\nThis project examines West Coast EEZs to identify suitable locations for oysters and other species, using SST rasters from 2008-2012, bathymetry data, and EEZ boundaries. The analysis employs raster and vector methods, including resampling, masking, and map algebra, and develops a reusable function to map suitability by species. My personal statement is to understand how environmental constraints shape aquaculture opportunities and to create a spatial workflow that can guide sustainable and commercially feasible marine farming along the West Coast.\n\n### Data Access\nAll data can be downloaded via this google drive, provided by Ruth Oliver on EDS 223- Homework Assignment 4- Prioritizing potential aquaculture: https://drive.google.com/file/d/1u-iwnPDbe6ZK7wSFVMI-PpCKaRQ3RVmg/view?usp=sharing\n\n**Data Source:** Historical sea surface temperature (SST) rasters, bathymetry data, and West Coast EEZ shapefiles to identify suitable habitat for marine species aquaculture.\n\n### Sea Surface Temperature\n- National Environmental Satellite Data, and Information Service. Coral Reef Watch. NOAA's 5km Daily Global Satellite Sea Surface Temperature Anomaly v3.1, Data Files, SST rasters: https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php \n`avg_08, avg_09, avg_10, avg_11, avg_12`\n\n\n### Bathymetry\n- General Bathymetric Chart of the Oceans (GEBCO).Depth raster,`depth.tif`. https://www.gebco.net/data-products/gridded-bathymetry-data#area\n\n### Exclusive Economic Zones (EEZ)\n- Maritime boundaries using EEZ polygons off the west coast of the US. `wc_regions_clean.shp`. https://www.marineregions.org/eez.php\n\n### Choosing a New Species - Integrate Function\n- Find information on species depth and temperature requirements from SeaLife Base for marine aquaculture, a reasonable potential for commercial consumption. https://www.sealifebase.ca/search.php\n\n# Data Preparation\n### Importing libraries\nThese are the libraries that will be used throughout this document.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\nlibrary(dismo)\nlibrary(tmap)\nlibrary(here)\nlibrary(knitr)\nlibrary(kableExtra)\nlibrary(dplyr)\n```\n:::\n\n\n### Import Data\nWhen adding data into folder, make sure to add data folder to `.gitignore` to avoid attempting to push any large data onto your reprository.\n\n::: {.cell}\n\n```{.r .cell-code}\n# load raster dataset\n# SST Data\navg_08 <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"average_annual_sst_2008.tif\"))\navg_09 <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"average_annual_sst_2009.tif\"))\navg_10 <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"average_annual_sst_2010.tif\"))\navg_11 <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"average_annual_sst_2011.tif\"))\navg_12 <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"average_annual_sst_2012.tif\"))\n\ndepth <- rast(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"depth.tif\"))\n\n# Reading in Shapefile- EEZ Data\nregions <- st_read(here(\"blog_post\",\"prioritizing_west_coast_aquaculture_sites\",\"data\",\"wc_regions_clean.shp\"),  quiet = TRUE)\n```\n:::\n\n\n### Matching CRS for Rasters\nBefore proceeding with spatial analysis, it is important to check that all Coordinate Reference Systems (CRS) match in order to combine or overlay spatial data. When CRS do not match, spatial analysis and manipulation cannot be completed accurately. Here I check if all CRS match across the SST files, depth raster, and regions vector data. If any files do not match, they will be transformed to match the reference CRS (avg_08).\nIn this first code chunk I will show if the CRS match it will print CRS match, and if it does not match it will give a warning and continue with a transformation. After the transformation it will print a statement that says CRS now match with.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check CRS from SST files\nif(crs(avg_08) == crs(avg_09)) {\n  print(\"Coordinate reference systems match:)\")\n} else{\n  warning(\"Updating coordinate reference systems to match :(\")}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Coordinate reference systems match:)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# check and transform coordinate reference systems\nif (crs(avg_08) == crs(depth)) {\n  print(\"Coordinate reference systems match :)\")\n} else {\n  warning(\"Updating coordinate reference systems to match :(\")\n  # transform raster to match avg_08\n  depth <- project(depth, crs(avg_08))\n    print(\"Depth coordinate reference systems match after transformation :)\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Updating coordinate reference systems to match :(\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Depth coordinate reference systems match after transformation :)\"\n```\n\n\n:::\n:::\n\nIn this code chunk, I will do the same process to check the CRS's of the rest of the files.\n\n::: {.cell}\n\n```{.r .cell-code}\n# check and transform coordinate reference systems\nif(crs(avg_08) == crs(avg_10)) {\n  print(\"Coordinate reference systems match:)\")\n} else{\n  warning(\"Updating coordinate reference systems to match :(\")}\n\n# check and transform coordinate reference systems\nif(crs(avg_08) == crs(avg_11)) {\n  print(\"Coordinate reference systems match:)\")\n} else{\n  warning(\"Updating coordinate reference systems to match :(\")}\n\n# check and transform coordinate reference systems\nif(crs(avg_08) == crs(avg_12)) {\n  print(\"Coordinate reference systems match :)\")\n} else{\n  warning(\"Updating coordinate reference systems to match :(\")}\n\n# check and transform coordinate reference systems\nif (crs(avg_08) == crs(regions)) {\n  print(\"Coordinate reference systems match :)\")\n} else {\n  warning(\"Updating coordinate reference systems to match :(\")\n    # transform raster to match avg_08\n  regions <- st_transform(regions, crs(avg_08))\n    print(\"Regions coordinate reference systems match after transformation :)\")\n}  \n```\n:::\n\n# Data Processing\n### Combine SST rasters into a raster stack\nTo identify suitable habitats for oysters, we first combined five SST rasters (avg_08–avg_12) into a single dataset and calculated the mean SST, converting values from Kelvin to Celsius by subtracting 273.15. Depth data were then cropped and resampled to align with the SST raster, ensuring that all spatial layers had matching extents, resolutions, and coordinate reference systems. Next, we applied environmental thresholds depths between 0–70 meters and SSTs between 11–30°C to identify areas suitable for oyster aquaculture. Locations meeting both criteria were marked as suitable, producing a raster layer that will be mapped to highlight potential oyster habitats. This processing ensures that subsequent analysis and mapping accurately reflect the intersection of temperature and depth requirements across West Coast EEZs, as demonstrated in the following code chunks.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Combining rasters\nsst_stack <- c(avg_08, avg_09, avg_10, avg_11, avg_12)\n\n# Mean of all Rasters and Converting temp values  K -> °C\nsst_mean <- mean(sst_stack) - 273.15\nnames(sst_mean) <- \"sst_mean\"\n```\n:::\n\n\n### Crop, Extent, Resolution\n\n::: {.cell}\n\n```{.r .cell-code}\n# Obtain geographic extent/bounding box of species occurrences\nst_bbox(sst_mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      xmin       ymin       xmax       ymax \n-131.98475   29.99305 -114.98672   49.98842 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Crop depth to the SST extent \ndepth_crop <- crop(depth, ext(sst_mean))\n\n# Resample depth to match SST resolution\ndepth_resampled <- resample(depth_crop, sst_mean, method = \"near\")\n\n# Check Resolution\nif (all(res(sst_mean) == res(depth_resampled))) {\n  print(\"Resolutions match :)\")\n} else {\n  print(\"Fix resolution :(\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Resolutions match :)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check Extent\nif (all(ext(sst_mean) == ext(depth_resampled))) {\n  print(\"Extent match :)\")\n} else {\n  print(\"Fix Extent :(\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Extent match :)\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Check CRS\nif (crs(sst_mean) == crs(depth_resampled)) {\n  print(\"CRS match :)\")\n} else {\n  print(\"Fix CRS :(\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CRS match :)\"\n```\n\n\n:::\n:::\n\n\n\n### Find Suitable Locations for Depth and SST\nTo identify suitable locations for oyster aquaculture, we need to find areas that meet both temperature and depth requirements. This is done by reclassifying each raster to indicate suitable (1) vs. unsuitable (0) conditions, then combining them to find locations where both criteria are satisfied.\n\n::: {.cell}\n\n```{.r .cell-code}\n# Reclassification matrix for: Suitable temperatures (11-30°C)\nrcl_sst <- matrix(c(-Inf, 11, 0, \n                        11, 30, 1,\n                        30, Inf, 0), ncol = 3, byrow = TRUE)\n\n# Use classify function\nreclassified_sst <- terra::classify(sst_mean, rcl = rcl_sst)\n\n\n# Define the reclassification matrix for Depth\nrcl_depth <- matrix(c(-Inf, -70, 0, \n                        -70, 0, 1,\n                        0, Inf, 0), ncol = 3, byrow = TRUE)\n\n# Use classify function\nreclassified_depth <- classify(depth_resampled, rcl_depth)\n\n# Combine Oyster and Depth for suitability\nsuitable <- reclassified_sst * reclassified_depth # Min = 0, Max = 1\n\n#Map it\ntm_shape(suitable) +\n  tm_raster(title = \"Habitat Suitability\") +   # short legend title\n  tm_title(\"Suitability - Depth and Location for Oysters\\n1 = Suitable, 0 = Unsuitable\") +  # subtitle with explanation\n  tm_layout(legend.outside.position = TRUE) +\n  tm_scale_bar(position = c(-.01, 0.08)) +\n  tm_compass(position = c(\"left\", \"top\")) +\n  tm_basemap(\"Esri.OceanBasemap\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nThis map shows areas where both temperature and depth requirements are met (shown in dark blue). This visualization serves as a check to ensure the reclassification process worked correctly before proceeding with further analysis.\n\n# Data Analysis\n### Rasterize, Masking, CellSize, and Zonal \nWe want to determine the total suitable area within each EEZ in order to rank zones by priority. To do so, we need to find the total area of suitable locations within each EEZ. This will be completed by select suitable cells within West Coast EEZs\nfind area of grid cells and find the total suitable area within each EEZ.\n\n::: {.cell}\n\n```{.r .cell-code}\neez_rast <- rasterize(regions, \n                 # template- using extent, resolution, crs\n                 suitable, \n                 # use region column\n                 field = \"rgn\")\n\n\n# Mask\nsuitable_mask <- mask(suitable,regions)\n\n# Cell size\ncell_area <- cellSize(suitable_mask, unit = \"km\")\n\n# Sum suitable area by EEZ\narea_by_eez_zonal <- zonal(cell_area * suitable_mask, eez_rast, fun = \"sum\", na.rm = TRUE) %>% \n  rename(\"suitable_area_km2\" = area) %>% \n  mutate(suitable_area_km2 = as.numeric(suitable_area_km2)) %>% \n  as_tibble() %>% \n  arrange(desc(suitable_area_km2))\n\n\narea_by_eez_zonal %>%\n  mutate(suitable_area_km2 = round(suitable_area_km2, 2)) %>% \n  kbl(\n    caption = \"Suitable Area by EEZ (km²)\",\n    col.names = c(\"EEZ Region\", \"Suitable Area (km²)\")\n  ) %>%\n  kable_classic(full_width = FALSE, html_font = \"Arial\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Arial; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Suitable Area by EEZ (km²)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> EEZ Region </th>\n   <th style=\"text-align:right;\"> Suitable Area (km²) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 4069.88 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 3757.28 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 2378.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 1074.27 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 178.03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\nIn this table we can now see the suitable area covered by each EEZ region for Oysters. Let's go ahead and see view this in a map to visually see our results.\n\n### Viewing EEZ Regions and Suitable Areas\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(regions) +\n  tm_polygons(\"rgn\", palette = \"Set3\", title = \"EEZ Regions\", alpha = 1) +\ntm_shape(suitable_mask) +\n  tm_raster(alpha = 0.6, title = \"Suitable Area (km²)\") +\ntm_shape(regions) +\n  # Adding labels\n  tm_text(\"rgn\", size = 0.5) +   \ntm_layout(\n  legend.outside.position = TRUE)+\ntm_scale_bar(position = c(-.01, 0.08)) +\ntm_compass(position = c(\"right\", \"top\"))+\n  tm_basemap(\"Esri.OceanBasemap\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\nThe map displays EEZ regions with suitable habitat areas overlaid. Because the suitable area raster and EEZ polygon boundaries are stored separately, they appear as distinct layers. In the following step, we will join the area calculations to the EEZ polygons to determine what percentage of each zone is suitable for oyster aquaculture.\n\n### Combine Dataframes - Regions and Area Zonal \nTo understand not just the absolute area, but what proportion of each EEZ is suitable for oyster aquaculture, we join the suitable area calculations to the EEZ spatial data and calculate the percentage of each region that meets the habitat requirements.\n\n::: {.cell}\n\n```{.r .cell-code}\n#Set as simple features to conserve geometry\nregion_sf <- st_as_sf(regions)\n\n# Join zonal data and calculate percentage \neez_sf <- region_sf %>%\n  left_join(area_by_eez_zonal, by = \"rgn\") %>%\n  mutate(perc_area_km2 = (suitable_area_km2/area_km2) * 100)\n\n\n# Table \neez_sf %>% \n  st_drop_geometry() %>% \n  as_tibble() %>% \n  dplyr::select(rgn, suitable_area_km2, perc_area_km2) %>% \n  mutate(\n    suitable_area_km2 = round(suitable_area_km2, 2),\n    perc_area_km2 = round(perc_area_km2, 2)\n  ) %>% \n  kbl(\n    caption = \"Suitable Area and Percentage by EEZ\",\n    col.names = c(\"EEZ Region\", \"Suitable Area (km²)\", \"Percent of Region (%)\")\n  ) %>% \n  kable_classic(full_width = FALSE, html_font = \"Arial\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Arial; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Suitable Area and Percentage by EEZ</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> EEZ Region </th>\n   <th style=\"text-align:right;\"> Suitable Area (km²) </th>\n   <th style=\"text-align:right;\"> Percent of Region (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 1074.27 </td>\n   <td style=\"text-align:right;\"> 0.60 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 178.03 </td>\n   <td style=\"text-align:right;\"> 0.11 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 4069.88 </td>\n   <td style=\"text-align:right;\"> 2.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 3757.28 </td>\n   <td style=\"text-align:right;\"> 1.82 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 2378.31 </td>\n   <td style=\"text-align:right;\"> 3.56 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n- The table shows the suitable area for oyster aquaculture across West Coast EEZs. Central California has the largest suitable area at 4,070 km², followed by Southern California with 3,757 km². Washington and Oregon have moderate areas of 2,378 km² and 1,074 km². Northern California has the smallest at 178 km². Overall, the most favorable regions for oyster aquaculture are Central and Southern California.\n\n### Oyster Aquaculture Suitability by Region\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setting color palette\ncolors <- c(\"#a6761d\",\"#e9c46a\",\"#90be6d\",\"#43aa8b\",\"#577590\", \"#6a4c93\") \n# Map It\ntm_shape(eez_sf) +\n  tm_polygons(\n    \"suitable_area_km2\",\n    palette = colors,\n    style = \"cont\",\n    title = \"Suitable Area (km²)\",\n    alpha = 0.9\n  ) +\n  tm_text(\n    \"rgn\",\n    size = 0.45,\n    col = \"black\",\n    fontface = \"bold\",\n    bgcol = \"antiquewhite\",\n    bgcol_alpha = 0.2) +\n  tm_layout(\n    main.title = \"Suitable Area for Oyster Aquaculture in California EEZs\\nBased on Temperature & Depth Criteria\",\n    main.title.size = 0.8,       # Controls title + subtitle size\n    main.title.fontface = \"bold\",\n    legend.outside = TRUE,\n    legend.outside.position = \"right\",\n    component.autoscale = FALSE,\n    outer.margins = c(0.01, 0.25, 0.01, 0.05)\n  ) +\n  tm_scale_bar(position = c(-.02, 0.08)) +\n  tm_compass(\n    type = \"arrow\",\n    position = c(\"right\", \"top\")\n  )+\n  tm_basemap(\"Esri.OceanBasemap\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\nThis map visualizes the total suitable area for oyster aquaculture within each West Coast EEZ. The color gradient indicates the magnitude of suitable habitat, with darker colors representing larger suitable areas. Central and Southern California EEZs (darker shades) contain the most extensive suitable habitat, while Northern California shows minimal suitable area. The spatial pattern reflects the combined influence of ocean temperature and bathymetry meeting oyster habitat requirements.\n\n# Generalizable Suitability Analysis Function\nTo view habitat suitability for multiple species, I developed a reusable function that automates the entire workflow that was ran previously: reclassification matrix, calculating suitable areas by EEZ, and generating summary outputs. This function can be applied to any marine species with known temperature and depth requirements.\n\n### *Note*:\nBefore running the function, make sure the datasets are loaded and that their coordinate reference systems (CRS), spatial extents, resolutions, and geometries match.\n\n::: {.cell}\n\n```{.r .cell-code}\nsuit_func <- function(\n  # Parameters\n  sst_raster,\n  depth_raster,\n  eez_sf,\n  min_sst,\n  max_sst,\n  min_depth,\n  max_depth,\n  species_name\n) {\n\n\n  # Reclassify Depth\n  rcl_depth <- matrix(c(\n    -Inf, min_depth, 0,\n     min_depth, max_depth, 1,\n     max_depth, Inf, 0\n  ), byrow = TRUE, ncol = 3)\n\n  depth_suit <- classify(depth_raster, rcl_depth)\n\n  # Reclassify SST\n  rcl_sst <- matrix(c(\n    -Inf, min_sst, 0,\n     min_sst, max_sst, 1,\n     max_sst, Inf, 0\n  ), byrow = TRUE, ncol = 3)\n\n  sst_suit <- classify(sst_raster, rcl_sst)\n\n  # Combine Stack\n  suit_env <- depth_suit * sst_suit\n\n  # Mask\n  suit_mask <- mask(suit_env,regions)\n\n  # Rasterize EEZ polygons to match raster grid\n  eez_rast <- terra::rasterize(eez_sf, suit_mask, field = \"rgn\")\n\n  # Zonal area (km^2)\n  cell_area <- cellSize(suit_mask, unit = \"km\")\n\n  area_table <- zonal(cell_area * suit_mask, eez_rast, fun = \"sum\", na.rm = TRUE) %>%\n  rename(\"suitable_area_km2_new\" = area) %>%\n  mutate(suitable_area_km2 = as.numeric(suitable_area_km2_new)) %>%\n  as_tibble() %>%\n  arrange(desc(suitable_area_km2))\n\n  # Join back to EEZ polygons for mapping\n  eez_joined <- left_join(eez_sf, area_table, by = \"rgn\")\n\n    # Create table\n  eez_table <- eez_joined %>%\n    st_drop_geometry() %>%\n    # to view for each species\n    as.data.frame() %>%\n    # select columns to show in figure\n    dplyr::select(rgn, suitable_area_km2_new) %>%\n    # rename column\n    rename(Region = rgn) %>%\n    # new column\n    mutate(suitable_area_km2_new = round(suitable_area_km2_new, 2)) %>%\n    rename(\"Suitable Area(km²)\" = suitable_area_km2_new)\n\n\n  # Plot It!\n  suit_func_map <-\n    tm_shape(eez_joined) +\n      tm_polygons(\n        \"suitable_area_km2_new\",\n        palette = \"-mako\",\n        style = \"cont\",\n        title = \"Suitable Area (km²)\"\n      ) +\n      tm_text(\"rgn\",\n              size = 0.45,\n              col = \"black\",\n              fontface = \"bold\",\n              bgcol = \"antiquewhite\",\n              bgcol_alpha = 0.2) +\n      tm_layout(\n        main.title = paste(\n          \"Suitable Area for\", species_name,\n          \"\\nBased on Preferred Temperature and Depth\"\n        ),\n        main.title.size = 0.8,\n        main.title.fontface = \"bold\",\n        legend.outside = TRUE,\n        legend.outside.position = \"right\",\n        component.autoscale = FALSE,\n        outer.margins = c(0.01, 0.25, 0.01, 0.05)\n      ) +\n      tm_scale_bar(position = c(-.02, 0.08)) +\n      tm_compass(type = \"arrow\", position = c(\"right\", \"top\"))+\n      tm_basemap(\"OpenStreetMap\")\n\n  table_eez<- eez_table %>%\n  # Add a cleaned up table\n  kable(digits = 2, caption = paste(\"Suitable Area for\", species_name)) %>% \n    kable_styling()\n\n# This will return Map and Table\n  return(table_eez)\n  return(suit_func_map)\n}\n```\n:::\n\n\n### Use Function with New Species\n### California sea hare (*Aplysia californica*)\nI was personally interested in the California sea hare, becuase they are considered algae cleaners and are used for their biomedical usage for aquacultures. Using the [SeaLifeBase](https://www.sealifebase.ca/search.php) [^3], I was able to find the depth range and the sea level range, which are the parameters needed for the function above. The function will create a table and a map to visually see the suitable areas for the California sea hare. The depth range: 0 - 22 m, and the sea level temperatures between 13.4 - 27.1 °C.\n\n::: {.cell}\n\n```{.r .cell-code}\n# California sea hare\nsuit_func(\n  sst_raster = sst_mean,\n  depth_raster = depth_resampled,\n  eez_sf = eez_sf,\n  min_sst = 13.4,\n  max_sst = 27.1,\n  min_depth = -22,\n  max_depth = 0,\n  species_name = \"California Sea Hare (<i>Aplysia californica</i>)\"\n)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Suitable Area for California Sea Hare (<i>Aplysia californica</i>)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Suitable Area(km²) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 118.79 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 499.63 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- The California sea hare, *Aplysia californica*, has suitable habitat primarily in Central California (118.79 km²) and Southern California (499.63 km²). No suitable habitat was identified in Oregon, Northern California, or Washington.\n\n### California spiny lobster (*Panulirus Interruptus*)\nHere I am testing another marine species, `California spiny lobster`[^4], to test the function and insure it works for another species with the parameters, which occupies habitat between 0-150 meters below sea level and between 12-24°C.\n\n::: {.cell}\n\n```{.r .cell-code}\nsuit_func(\n  sst_raster = sst_mean,\n  depth_raster = depth_resampled,\n  eez_sf = eez_sf,\n  min_sst = 12,\n  max_sst = 24,\n  min_depth = -150,\n  max_depth = 0,\n  species_name = \"California spiny lobster (<i>Panulirus Interruptus</i>)\"\n)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Suitable Area for California spiny lobster (<i>Panulirus Interruptus</i>)</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Region </th>\n   <th style=\"text-align:right;\"> Suitable Area(km²) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Oregon </td>\n   <td style=\"text-align:right;\"> 585.03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Northern California </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Central California </td>\n   <td style=\"text-align:right;\"> 3992.41 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Southern California </td>\n   <td style=\"text-align:right;\"> 8093.85 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Washington </td>\n   <td style=\"text-align:right;\"> 175.57 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- The California spiny lobster (*Panulirus Interruptus*) has suitable habitat primarily in Southern California (8093.85 km²), Central California (3992.41 km²), Oregon (585.03 km²), and Washington (175.57 km²). No suitable habitat was identified in Northern California.\n\n# Conclusion\n\nOverall, this workflow successfully identified suitable habitat areas for marine species, with the ability to map suitability for any species available through SeaLifeBase. However, the analysis is limited by the use of average SST data from 2008–2012 and the exclusion of other important environmental and human driven factors such as habitat type, food resources, and coastal activities. Future work should incorporate more recent or seasonal temperature datasets, additional environmental predictors, and potentially other spatial layers to improve accuracy and support real world management or aquaculture planning.\n\n[^1]: Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & O’Keefe, M. \n      Blue Frontiers: Managing the Environmental Costs of Aquaculture \n      (The WorldFish Center, Penang, Malaysia, 2011)\n\n[^2]: https://www.nature.com/articles/s41559-017-0257-9\n\n[^3]: https://www.sealifebase.ca/summary/Aplysia-californica\n\n[^4]: https://www.sealifebase.ca/summary/Panulirus-interruptus\n\n# References\n- Assignment 4: Prioritizing potential aquaculture. EDS 223 – Geospatial Analysis & Remote Sensing, 2025. https://eds-223-geospatial.github.io/assignments/HW4.html. Accessed 13 Nov. 2025.\n- Hall, S. J., Delaporte, A., Phillips, M. J., Beveridge, M. & O’Keefe, M. Blue Frontiers: Managing the Environmental Costs of   Aquaculture (The WorldFish Center, Penang, Malaysia, 2011).︎\n- Gentry, R. R., Froehlich, H. E., Grimm, D., Kareiva, P., Parke, M., Rust, M., Gaines, S. D., & Halpern, B. S. Mapping the global potential for marine aquaculture. Nature Ecology & Evolution, 1, 1317-1324 (2017).\n- GEBCO Compilation Group (2022) GEBCO_2022 Grid (doi:10.5285/e0f0bb80-ab44-2739-e053-6c86abc0289c).\n- Sealifebase. (2025). Aplysia californica (California sea hare). https://www.sealifebase.ca/summary/Aplysia-californica \n- Sealifebase. (2025). Panulirus interruptus (California spiny lobster). https://www.sealifebase.ca/summary/Panulirus-interruptus\n- The Water Brothers. (n.d.). Still from an animation of GreenWave’s regenerative ocean farming system [Image]. The Water Brothers. https://thewaterbrothers.ca/\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}